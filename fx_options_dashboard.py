<full canvas code inserted here>